<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Diego 2026">
    <meta name="theme-color" content="#667eea">
    <title>Diego 2026 - Sistema Completo</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        :root {
            --primary: #667eea;
            --primary-dark: #5568d3;
            --secondary: #764ba2;
            --success: #28a745;
            --warning: #ffc107;
            --danger: #dc3545;
            --light: #f8f9fa;
            --dark: #343a40;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            min-height: 100vh;
            padding: 0;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
        }
        
        .app-container {
            max-width: 100%;
            min-height: 100vh;
            background: white;
        }
        
        .app-header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .app-header h1 {
            font-size: 1.5em;
            margin-bottom: 5px;
        }
        
        .content {
            padding: 20px;
            padding-bottom: 80px;
            min-height: calc(100vh - 140px);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .section {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .section-title {
            font-size: 1.3em;
            color: var(--primary);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .progress-ring {
            width: 150px;
            height: 150px;
            margin: 20px auto;
            position: relative;
        }
        
        .progress-ring svg {
            transform: rotate(-90deg);
        }
        
        .progress-ring-circle {
            fill: none;
            stroke: var(--light);
            stroke-width: 12;
        }
        
        .progress-ring-progress {
            fill: none;
            stroke: var(--success);
            stroke-width: 12;
            stroke-linecap: round;
            transition: stroke-dashoffset 0.5s ease;
        }
        
        .progress-ring-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2em;
            font-weight: bold;
            color: var(--primary);
        }
        
        .task-item {
            background: var(--light);
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
            user-select: none;
        }
        
        .task-item.completed {
            background: #d4edda;
            opacity: 0.7;
        }
        
        .task-item.completed .task-text {
            text-decoration: line-through;
        }
        
        .task-checkbox {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            border: 3px solid var(--primary);
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
        }
        
        .task-item.completed .task-checkbox {
            background: var(--success);
            border-color: var(--success);
        }
        
        .task-checkbox::after {
            content: '‚úì';
            color: white;
            font-size: 18px;
            font-weight: bold;
            opacity: 0;
        }
        
        .task-item.completed .task-checkbox::after {
            opacity: 1;
        }
        
        .task-emoji {
            font-size: 1.5em;
            flex-shrink: 0;
        }
        
        .task-content {
            flex: 1;
        }
        
        .task-text {
            font-size: 1em;
            color: var(--dark);
            margin-bottom: 3px;
        }
        
        .task-time {
            font-size: 0.85em;
            color: #666;
        }
        
        .philosophy-card {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            border-left: 4px solid var(--primary);
        }
        
        .philosophy-card .quote {
            font-style: italic;
            font-size: 1.1em;
            color: var(--dark);
            margin-bottom: 10px;
        }
        
        .philosophy-card .author {
            text-align: right;
            color: #666;
            font-size: 0.9em;
        }
        
        .kaizen-input {
            width: 100%;
            padding: 15px;
            border: 2px solid var(--light);
            border-radius: 8px;
            font-size: 1em;
            margin-top: 10px;
        }
        
        .timeline-item {
            background: var(--light);
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 12px;
            border-left: 4px solid var(--primary);
        }
        
        .timeline-item.next {
            background: #fff3cd;
            border-left-color: var(--warning);
        }
        
        .timeline-item.done {
            opacity: 0.6;
            border-left-color: var(--success);
        }
        
        .goal-card {
            background: var(--light);
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 12px;
        }
        
        .goal-title {
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 15px;
            color: var(--dark);
        }
        
        .goal-progress-bar {
            height: 30px;
            background: #e9ecef;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
            margin-bottom: 10px;
        }
        
        .goal-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--success), #20c997);
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        
        .pdca-section {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 15px;
        }
        
        .pdca-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border: 2px solid var(--light);
        }
        
        .pdca-item h4 {
            color: var(--primary);
            margin-bottom: 10px;
        }
        
        .btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            margin-top: 10px;
        }
        
        .btn-secondary {
            background: #6c757d;
        }
        
        .btn-success {
            background: var(--success);
        }
        
        .btn-danger {
            background: var(--danger);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }
        
        .stat-number {
            font-size: 2em;
            font-weight: bold;
        }
        
        .reflection-section textarea {
            width: 100%;
            min-height: 80px;
            padding: 12px;
            border: 2px solid var(--light);
            border-radius: 8px;
            margin-top: 10px;
            font-family: inherit;
            resize: vertical;
        }
        
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-around;
            padding: 10px 0;
            z-index: 200;
        }
        
        .nav-item {
            flex: 1;
            text-align: center;
            padding: 8px;
            cursor: pointer;
            color: #666;
            transition: all 0.3s;
        }
        
        .nav-item.active {
            color: var(--primary);
        }
        
        .nav-icon {
            font-size: 1.5em;
            margin-bottom: 3px;
        }
        
        .nav-label {
            font-size: 0.7em;
        }
        
        .toast {
            position: fixed;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--dark);
            color: white;
            padding: 15px 25px;
            border-radius: 25px;
            z-index: 2000;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .toast.show {
            opacity: 1;
        }
        
        .week-days {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 8px;
        }
        
        .day-badge {
            aspect-ratio: 1;
            background: var(--light);
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }
        
        .day-badge.completed {
            background: linear-gradient(135deg, var(--success), #20c997);
            color: white;
        }
        
        @media (min-width: 768px) {
            .app-container {
                max-width: 768px;
                margin: 0 auto;
                box-shadow: 0 0 30px rgba(0,0,0,0.2);
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <div class="app-header">
            <h1>‚ö° Diego 2026</h1>
            <div id="headerDate"></div>
        </div>
        
        <div class="content">
            <!-- ABA IN√çCIO -->
            <div id="tab-home" class="tab-content active">
                <div class="philosophy-card" id="dailyQuote"></div>
                
                <div class="section">
                    <div class="section-title">üìä Progresso do Dia</div>
                    <div class="progress-ring">
                        <svg width="150" height="150">
                            <circle class="progress-ring-circle" cx="75" cy="75" r="65"></circle>
                            <circle class="progress-ring-progress" cx="75" cy="75" r="65" 
                                    stroke-dasharray="408.4" stroke-dashoffset="408.4" id="progressCircle"></circle>
                        </svg>
                        <div class="progress-ring-text" id="progressText">0%</div>
                    </div>
                </div>
                
                <div class="section">
                    <div class="section-title">‚úÖ Checklist Di√°rio</div>
                    <div id="tasksList"></div>
                </div>
                
                <div class="section">
                    <div class="section-title">üîÑ Kaizen do Dia</div>
                    <label style="display: block; margin-bottom: 5px; font-weight: bold;">Uma melhoria para amanh√£ (+1%):</label>
                    <input type="text" class="kaizen-input" id="kaizenInput" placeholder="Ex: Acordar 5min mais cedo, delegar X tarefa...">
                    <button class="btn btn-success" onclick="saveKaizen()">üíæ Salvar Melhoria</button>
                </div>
                
                <div class="section">
                    <div class="section-title">üìÖ Progresso Semanal</div>
                    <div class="week-days" id="weekDays"></div>
                </div>
            </div>
            
            <!-- ABA AGENDA -->
            <div id="tab-agenda" class="tab-content">
                <div class="section">
                    <div class="section-title">üìÖ Timeline do Dia</div>
                    <div id="timelineList"></div>
                </div>
                
                <div class="section">
                    <div class="section-title">üìà Estat√≠sticas</div>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-number" id="statBooks">0</div>
                            <div>Livros</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="statWorkouts">0</div>
                            <div>Treinos</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="statPrayer">0</div>
                            <div>Ora√ß√µes</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="statFocus">0</div>
                            <div>Deep Work</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- ABA METAS -->
            <div id="tab-goals" class="tab-content">
                <div class="section">
                    <div class="section-title">üéØ Metas 2026 - M√©todo Falconi</div>
                    <div id="goalsDetailed"></div>
                </div>
                
                <div class="section">
                    <div class="section-title">üîÑ PDCA Semanal</div>
                    <div class="pdca-section">
                        <div class="pdca-item">
                            <h4>P - Plan</h4>
                            <textarea id="pdcaPlan" placeholder="Metas desta semana..."></textarea>
                        </div>
                        <div class="pdca-item">
                            <h4>D - Do</h4>
                            <textarea id="pdcaDo" placeholder="O que executei..."></textarea>
                        </div>
                        <div class="pdca-item">
                            <h4>C - Check</h4>
                            <textarea id="pdcaCheck" placeholder="Resultados obtidos..."></textarea>
                        </div>
                        <div class="pdca-item">
                            <h4>A - Act</h4>
                            <textarea id="pdcaAct" placeholder="Ajustes para pr√≥xima..."></textarea>
                        </div>
                    </div>
                    <button class="btn btn-success" onclick="savePDCA()">üíæ Salvar PDCA</button>
                </div>
            </div>
            
            <!-- ABA REFLEX√ÉO -->
            <div id="tab-reflection" class="tab-content">
                <div class="section">
                    <div class="section-title">üôè Exame Di√°rio</div>
                    <div class="reflection-section">
                        <label><strong>Servi hoje?</strong> (fam√≠lia, equipe, clientes)</label>
                        <textarea id="reflectServe"></textarea>
                        
                        <label><strong>Fui humilde?</strong> (reconheci erros?)</label>
                        <textarea id="reflectHumble"></textarea>
                        
                        <label><strong>3 Gratid√µes:</strong></label>
                        <textarea id="reflectGratitude" placeholder="1. &#10;2. &#10;3. "></textarea>
                        
                        <label><strong>Vivi com prop√≥sito eterno?</strong></label>
                        <textarea id="reflectPurpose"></textarea>
                        
                        <button class="btn btn-success" onclick="saveReflection()">üíæ Salvar Reflex√£o</button>
                    </div>
                </div>
                
                <div class="section">
                    <div class="section-title">üßò Controle Estoico</div>
                    <div class="reflection-section">
                        <label><strong>O que estava sob meu controle hoje?</strong></label>
                        <textarea id="stoicControl"></textarea>
                        
                        <label><strong>O que n√£o estava?</strong> (aceitei?)</label>
                        <textarea id="stoicAccept"></textarea>
                        
                        <label><strong>Agi com virtude?</strong> (sabedoria, justi√ßa, coragem, temperan√ßa)</label>
                        <textarea id="stoicVirtue"></textarea>
                        
                        <button class="btn btn-success" onclick="saveStoic()">üíæ Salvar Reflex√£o Estoica</button>
                    </div>
                </div>
            </div>
            
            <!-- ABA CONFIG -->
            <div id="tab-config" class="tab-content">
                <div class="section">
                    <div class="section-title">‚öôÔ∏è Configura√ß√µes</div>
                    <button class="btn" onclick="exportData()">üì• Exportar Dados</button>
                    <button class="btn btn-secondary" onclick="importData()">üì§ Importar Dados</button>
                    <button class="btn btn-danger" onclick="resetWeek()">üîÑ Resetar Semana</button>
                    <button class="btn btn-danger" onclick="resetAll()">‚ö†Ô∏è Resetar Tudo</button>
                </div>
                
                <div class="section">
                    <div class="section-title">üìö Sobre</div>
                    <p><strong>Diego 2026 - Sistema de Vida</strong></p>
                    <p>Vers√£o 3.0 - Filosofia Integrada</p>
                    <p style="margin-top: 15px;">Baseado em:</p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>üîÑ Kaizen (Melhoria Cont√≠nua)</li>
                        <li>üìä M√©todo Falconi (PDCA)</li>
                        <li>üôè Filosofia de Jesus</li>
                        <li>üßò Estoicismo - Marco Aur√©lio</li>
                        <li>üìà Peter Drucker</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="bottom-nav">
            <div class="nav-item active" onclick="switchTab('home')">
                <div class="nav-icon">üè†</div>
                <div class="nav-label">In√≠cio</div>
            </div>
            <div class="nav-item" onclick="switchTab('agenda')">
                <div class="nav-icon">üìÖ</div>
                <div class="nav-label">Agenda</div>
            </div>
            <div class="nav-item" onclick="switchTab('goals')">
                <div class="nav-icon">üéØ</div>
                <div class="nav-label">Metas</div>
            </div>
            <div class="nav-item" onclick="switchTab('reflection')">
                <div class="nav-icon">üôè</div>
                <div class="nav-label">Reflex√£o</div>
            </div>
            <div class="nav-item" onclick="switchTab('config')">
                <div class="nav-icon">‚öôÔ∏è</div>
                <div class="nav-label">Config</div>
            </div>
        </div>
        
        <div class="toast" id="toast"></div>
    </div>

    <script>
        const dailyTasks = [
            { id: 'treino', emoji: 'üèÉ', text: 'Treino matinal', time: '05:00', type: 'workout' },
            { id: 'evangelho', emoji: 'üìñ', text: 'Evangelho + Prov√©rbios', time: '06:30', type: 'prayer' },
            { id: 'cafe', emoji: '‚òï', text: 'Caf√© com esposa', time: '07:00', type: 'family' },
            { id: 'estrategia', emoji: 'üìù', text: 'Estrat√©gia escrita', time: '07:30', type: 'focus' },
            { id: 'mercado', emoji: 'üè¢', text: 'Mercado Lideran√ßa', time: '08:00', type: 'work' },
            { id: 'leitura-almoco', emoji: 'üìö', text: 'Leitura neg√≥cios', time: '12:00', type: 'reading' },
            { id: 'levels', emoji: 'ü•§', text: 'Levels Nutrition', time: '14:00', type: 'work' },
            { id: 'jantar', emoji: 'üë´', text: 'Jantar casal + ora√ß√£o', time: '18:00', type: 'family' },
            { id: 'leitura-noite', emoji: 'üìñ', text: 'Leitura leve', time: '21:00', type: 'reading' },
            { id: 'sono', emoji: 'üò¥', text: 'Dormir 22h', time: '21:45', type: 'health' }
        ];
        
        const goals2026 = [
            { title: 'üíº Faturamento 2026: R$ 7,0M', current: 4100000, target: 7000000, key: 'revenue' },
            { title: 'üè™ Unidades Operacionais', current: 3, target: 4, key: 'units' },
            { title: 'üè∑Ô∏è Marca Pr√≥pria Levels', current: 0, target: 400000, key: 'brand' },
            { title: 'üìä Margem L√≠quida', current: 10, target: 15, key: 'margin' },
            { title: '‚è±Ô∏è Horas Trabalho/Semana', current: 60, target: 40, key: 'worktime', reverse: true },
            { title: 'üìö Livros Lidos', current: 0, target: 52, key: 'books' }
        ];
        
        const quotes = [
            { text: "O obst√°culo √© o caminho", author: "Marco Aur√©lio" },
            { text: "Pequenas melhorias di√°rias levam a resultados surpreendentes", author: "Kaizen" },
            { text: "Quem n√£o mede, n√£o gerencia", author: "Vicente Falconi" },
            { text: "N√£o vim para ser servido, mas para servir", author: "Jesus Cristo" },
            { text: "Voc√™ tem poder sobre sua mente, n√£o sobre eventos externos", author: "Marco Aur√©lio" },
            { text: "O que n√£o pode ser medido n√£o pode ser melhorado", author: "Peter Drucker" }
        ];
        
        let currentData = null;
        
        async function loadData() {
            try {
                const result = await window.storage.get('diego-data-v3', false);
                if (result) return JSON.parse(result.value);
            } catch (e) {}
            
            return {
                tasks: dailyTasks.map(t => ({ ...t, completed: false })),
                stats: { books: 0, workouts: 0, prayer: 0, focus: 0 },
                week: Array(7).fill(false),
                goals: goals2026,
                kaizen: [],
                pdca: { plan: '', do: '', check: '', act: '' },
                reflection: {},
                stoic: {}
            };
        }
        
        async function saveData() {
            try {
                await window.storage.set('diego-data-v3', JSON.stringify(currentData), false);
            } catch (e) {
                console.error('Erro ao salvar:', e);
            }
        }
        
        function switchTab(tab) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            
            document.getElementById(`tab-${tab}`).classList.add('active');
            event.currentTarget.classList.add('active');
            
            if (tab === 'agenda') renderTimeline();
            if (tab === 'goals') renderGoalsDetailed();
        }
        
        function renderTasks() {
            const html = currentData.tasks.map((t, i) => `
                <div class="task-item ${t.completed ? 'completed' : ''}" onclick="toggleTask(${i})">
                    <div class="task-checkbox"></div>
                    <div class="task-emoji">${t.emoji}</div>
                    <div class="task-content">
                        <div class="task-text">${t.text}</div>
                        <div class="task-time">${t.time}</div>
                    </div>
                </div>
            `).join('');
            document.getElementById('tasksList').innerHTML = html;
            updateProgress();
        }
        
        function updateProgress() {
            const completed = currentData.tasks.filter(t => t.completed).length;
            const total = currentData.tasks.length;
            const percent = Math.round((completed / total) * 100);
            document.getElementById('progressText').textContent = percent + '%';
            const circle = document.getElementById('progressCircle');
            const offset = 408.4 - (percent / 100) * 408.4;
            circle.style.strokeDashoffset = offset;
        }
        
        async function toggleTask(i) {
            currentData.tasks[i].completed = !currentData.tasks[i].completed;
            if (currentData.tasks[i].completed) {
                const t = currentData.tasks[i];
                if (t.type === 'workout') currentData.stats.workouts++;
                if (t.type === 'prayer') currentData.stats.prayer++;
                if (t.type === 'reading') currentData.stats.books += 0.14;
            }
            await saveData();
            renderTasks();
            renderStats();
        }
        
        function renderWeek() {
            const days = ['D', 'S', 'T', 'Q', 'Q', 'S', 'S'];
            const html = currentData.week.map((done, i) => `
                <div class="day-badge ${done ? 'completed' : ''}" onclick="toggleDay(${i})">
                    <div>${days[i]}</div>
                    <div style="font-size: 1.2em;">${done ? '‚úÖ' : '‚≠ï'}</div>
                </div>
            `).join('');
            document.getElementById('weekDays').innerHTML = html;
        }
        
        async function toggleDay(i) {
            currentData.week[i] = !currentData.week[i];
            await saveData();
            renderWeek();
        }
        
        function renderStats() {
            document.getElementById('statBooks').textContent = currentData.stats.books.toFixed(1);
            document.getElementById('statWorkouts').textContent = currentData.stats.workouts;
            document.getElementById('statPrayer').textContent = currentData.stats.prayer;
            document.getElementById('statFocus').textContent = currentData.stats.focus;
        }
        
        function renderTimeline() {
            const now = new Date();
            const currentMinutes = now.getHours() * 60 + now.getMinutes();
            
            const html = currentData.tasks.map(t => {
                const [h, m] = t.time.split(':');
                const taskMinutes = parseInt(h) * 60 + parseInt(m);
                const isNext = taskMinutes > currentMinutes && taskMinutes <= currentMinutes + 60;
                const isDone = t.completed;
                
                return `
                    <div class="timeline-item ${isNext ? 'next' : ''} ${isDone ? 'done' : ''}">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <strong>${t.emoji} ${t.text}</strong>
                                <div style="font-size: 0.9em; color: #666;">${t.time}</div>
                            </div>
                            <div>${isDone ? '‚úÖ' : isNext ? '‚è∞' : '‚≠ï'}</div>
                        </div>
                    </div>
                `;
            }).join('');
            document.getElementById('timelineList').innerHTML = html;
        }
        
        function renderGoalsDetailed() {
            const html = currentData.goals.map((g, i) => {
                const progress = g.reverse 
                    ? Math.round((1 - (g.current - g.target) / (60 - g.target)) * 100)
                    : Math.round((g.current / g.target) * 100);
                const safe = Math.max(0, Math.min(100, progress));
                
                return `
                    <div class="goal-card">
                        <div class="goal-title">${g.title}</div>
                        <div class="goal-progress-bar">
                            <div class="goal-progress-fill" style="width: ${safe}%">${safe}%</div>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-top: 10px;">
                            <span>Atual: ${g.current}</span>
                            <span>Meta: ${g.target}</span>
                        </div>
                        <input type="number" placeholder="Atualizar valor" id="goal-${i}" 
                               style="width: 100%; padding: 8px; margin-top: 10px; border-radius: 5px; border: 2px solid #e9ecef;">
                        <button class="btn btn-success" onclick="updateGoal(${i})">Atualizar</button>
                    </div>
                `;
            }).join('');
            document.getElementById('goalsDetailed').innerHTML = html;
        }
        
        async function updateGoal(i) {
            const value = document.getElementById(`goal-${i}`).value;
            if (value) {
                currentData.goals[i].current = parseFloat(value);
                await saveData();
                renderGoalsDetailed();
                showToast('‚úÖ Meta atualizada!');
            }
        }
        
        async function saveKaizen() {
            const value = document.getElementById('kaizenInput').value;
            if (value) {
                currentData.kaizen.push({ date: new Date().toISOString(), text: value });
                await saveData();
                document.getElementById('kaizenInput').value = '';
                showToast('‚úÖ Kaizen salvo! +1% hoje!');
            }
        }
        
        async function savePDCA() {
            currentData.pdca = {
                plan: document.getElementById('pdcaPlan').value,
                do: document.getElementById('pdcaDo').value,
                check: document.getElementById('pdcaCheck').value,
                act: document.getElementById('pdcaAct').value
            };
            await saveData();
            showToast('‚úÖ PDCA salvo!');
        }
        
        async function saveReflection() {
            currentData.reflection = {
                serve: document.getElementById('reflectServe').value,
                humble: document.getElementById('reflectHumble').value,
                gratitude: document.getElementById('reflectGratitude').value,
                purpose: document.getElementById('reflectPurpose').value
            };
            await saveData();
            showToast('‚úÖ Reflex√£o salva!');
        }
        
        async function saveStoic() {
            currentData.stoic = {
                control: document.getElementById('stoicControl').value,
                accept: document.getElementById('stoicAccept').value,
                virtue: document.getElementById('stoicVirtue').value
            };
            await saveData();
            showToast('‚úÖ Reflex√£o estoica salva!');
        }
        
        function exportData() {
            const json = JSON.stringify(currentData, null, 2);
            const blob = new Blob([json], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `diego-backup-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            showToast('‚úÖ Dados exportados!');
        }
        
        function importData() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = async (e) => {
                const file = e.target.files[0];
                const text = await file.text();
                currentData = JSON.parse(text);
                await saveData();
                init();
                showToast('‚úÖ Dados importados!');
            };
            input.click();
        }
        
        async function resetWeek() {
            if (confirm('Resetar semana?')) {
                currentData.week = Array(7).fill(false);
                currentData.stats = { books: 0, workouts: 0, prayer: 0, focus: 0 };
                await saveData();
                init();
                showToast('‚úÖ Semana resetada!');
            }
        }
        
        async function resetAll() {
            if (confirm('‚ö†Ô∏è ATEN√á√ÉO! Isso apagar√° TODOS os dados. Tem certeza?')) {
                currentData = await loadData();
                await saveData();
                init();
                showToast('‚úÖ Tudo resetado!');
            }
        }
        
        function showToast(msg) {
            const toast = document.getElementById('toast');
            toast.textContent = msg;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 3000);
        }
        
        function showDailyQuote() {
            const quote = quotes[Math.floor(Math.random() * quotes.length)];
            document.getElementById('dailyQuote').innerHTML = `
                <div class="quote">"${quote.text}"</div>
                <div class="author">‚Äî ${quote.author}</div>
            `;
        }
        
        function updateDate() {
            const now = new Date();
            document.getElementById('headerDate').textContent = 
                now.toLocaleDateString('pt-BR', { weekday: 'long', day: 'numeric', month: 'long' });
        }
        
        async function init() {
            updateDate();
            currentData = await loadData();
            showDailyQuote();
            renderTasks();
            renderWeek();
            renderStats();
            
            if (currentData.pdca) {
                document.getElementById('pdcaPlan').value = currentData.pdca.plan || '';
                document.getElementById('pdcaDo').value = currentData.pdca.do || '';
                document.getElementById('pdcaCheck').value = currentData.pdca.check || '';
                document.getElementById('pdcaAct').value = currentData.pdca.act || '';
            }
            
            if (currentData.reflection) {
                document.getElementById('reflectServe').value = currentData.reflection.serve || '';
                document.getElementById('reflectHumble').value = currentData.reflection.humble || '';
                document.getElementById('reflectGratitude').value = currentData.reflection.gratitude || '';
                document.getElementById('reflectPurpose').value = currentData.reflection.purpose || '';
            }
            
            if (currentData.stoic) {
                document.getElementById('stoicControl').value = currentData.stoic.control || '';
                document.getElementById('stoicAccept').value = currentData.stoic.accept || '';
                document.getElementById('stoicVirtue').value = currentData.stoic.virtue || '';
            }
        }
        
        init();
        setInterval(updateDate, 60000);
    </script>
</body>
</html>
